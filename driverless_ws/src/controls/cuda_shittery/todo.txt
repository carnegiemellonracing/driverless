TODO: delete cuda_shittery?